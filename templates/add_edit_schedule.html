{% extends 'layout.html' %}

{% block title %}{% if schedule.id %}编辑排课{% else %}添加排课{% endif %}{% endblock %}

{% block content %}
<h1 class="mb-4">{% if schedule.id %}编辑排课{% else %}添加新排课{% endif %}</h1>

<form method="POST">
    <div class="mb-3">
        <label for="course_id" class="form-label">课程 <span class="text-danger">*</span></label>
        <select class="form-select" id="course_id" name="course_id" required>
            <option value="">请选择课程</option>
            {% for course in courses %}
            <option value="{{ course.id }}" {% if schedule.course_id == course.id %}selected{% endif %}>
                {{ course.name }} ({{ course.credits }}学分)
            </option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <label for="teacher_user_id" class="form-label">教师 <span class="text-danger">*</span></label>
        <select class="form-select" id="teacher_user_id" name="teacher_user_id" required>
            <option value="">请选择教师</option>
            {% for teacher in teachers %}
            <option value="{{ teacher.id }}" {% if schedule.teacher_user_id == teacher.id %}selected{% endif %}>
                {{ teacher.username }}
            </option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <label for="day_of_week" class="form-label">星期 <span class="text-danger">*</span></label>
        <select class="form-select" id="day_of_week" name="day_of_week" required>
            <option value="">请选择星期</option>
            {% for day in days_of_week %}
            <option value="{{ day }}" {% if schedule.day_of_week == day %}selected{% endif %}>
                {{ day }}
            </option>
            {% endfor %}
        </select>
    </div>
    <div class="row mb-3">
        <div class="col-md-6">
            <label for="start_time" class="form-label">开始时间 <span class="text-danger">*</span></label>
            <input type="time" class="form-control" id="start_time" name="start_time" value="{{ schedule.start_time or '' }}" required>
        </div>
        <div class="col-md-6">
            <label for="end_time" class="form-label">结束时间 <span class="text-danger">*</span></label>
            <input type="time" class="form-control" id="end_time" name="end_time" value="{{ schedule.end_time or '' }}" required>
        </div>
    </div>
    <div class="mb-3">
        <label for="location" class="form-label">教室 <span class="text-danger">*</span></label>
        <input type="text" class="form-control" id="location" name="location" value="{{ schedule.location or '' }}" required>
    </div>
    <div class="mb-3">
        <label for="semester" class="form-label">学期</label>
        <input type="text" class="form-control" id="semester" name="semester" value="{{ schedule.semester or '2023-2024 Fall' }}">
    </div>
    <button type="submit" class="btn btn-primary">{% if schedule.id %}更新{% else %}添加{% endif %}</button>
    <a href="{{ url_for('schedules') }}" class="btn btn-secondary">取消</a>
</form>
{% endblock %}
