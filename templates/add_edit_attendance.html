<!-- add_edit_attendance.html -->
{% extends 'layout.html' %}

{% block title %}{% if attendance_record.id %}编辑考勤记录{% else %}添加考勤记录{% endif %}{% endblock %}

{% block content %}
<h1 class="mb-4">{% if attendance_record.id %}编辑考勤记录{% else %}添加考勤记录{% endif %}</h1>

<form method="POST" action="{% if attendance_record.id %}{{ url_for('edit_attendance', id=attendance_record.id) }}{% else %}{{ url_for('add_attendance') }}{% endif %}">
    <div class="mb-3">
        <label for="student_id" class="form-label">学生 <span class="text-danger">*</span></label>
        <select class="form-select" id="student_id" name="student_id" required>
            <option value="">请选择学生</option>
            {% for student in students %}
                <option value="{{ student.id }}" {% if attendance_record.student_id == student.id %}selected{% endif %}>{{ student.name }} ({{ student.student_id }})</option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <label for="date" class="form-label">日期 <span class="text-danger">*</span></label>
        <input type="date" class="form-control" id="date" name="date" value="{{ attendance_record.date or '' }}" required>
    </div>
    <div class="mb-3">
        <label for="status" class="form-label">状态 <span class="text-danger">*</span></label>
        <select class="form-select" id="status" name="status" required>
            <option value="">请选择状态</option>
            <option value="present" {% if attendance_record.status == 'present' %}selected{% endif %}>出勤</option>
            <option value="absent" {% if attendance_record.status == 'absent' %}selected{% endif %}>缺勤</option>
            <option value="leave" {% if attendance_record.status == 'leave' %}selected{% endif %}>请假</option>
        </select>
    </div>
    <div class="mb-3">
        <label for="reason" class="form-label">原因</label>
        <textarea class="form-control" id="reason" name="reason" rows="3">{{ attendance_record.reason or '' }}</textarea>
    </div>
    <button type="submit" class="btn btn-primary">保存</button>
    <a href="{{ url_for('attendance') }}" class="btn btn-secondary">取消</a>
</form>
{% endblock %}
