{% extends 'layout.html' %}

{% block title %}{% if notice.id %}编辑通知{% else %}发布新通知{% endif %}{% endblock %}

{% block content %}
<h1 class="mb-4">{% if notice.id %}编辑通知{% else %}发布新通知{% endif %}</h1>

<form method="POST" action="{% if notice.id %}{{ url_for('edit_notice', id=notice.id) }}{% else %}{{ url_for('add_notice') }}{% endif %}">
    <div class="mb-3">
        <label for="title" class="form-label">标题 <span class="text-danger">*</span></label>
        <input type="text" class="form-control" id="title" name="title" value="{{ notice.title or '' }}" required>
    </div>
    <div class="mb-3">
        <label for="content" class="form-label">内容 <span class="text-danger">*</span></label>
        <textarea class="form-control" id="content" name="content" rows="5" required>{{ notice.content or '' }}</textarea>
    </div>
    <div class="mb-3">
        <label for="target" class="form-label">目标受众 (例如: 'all', 'class:三年二班', 'student:张三')</label>
        <input type="text" class="form-control" id="target" name="target" value="{{ notice.target or 'all' }}">
        <div class="form-text">默认为 'all' (所有用户)。指定班级请用 'class:班级名称'，指定学生请用 'student:学生姓名'。</div>
    </div>
    <button type="submit" class="btn btn-primary">保存/发布</button>
    <a href="{{ url_for('notices') }}" class="btn btn-secondary">取消</a>
</form>
{% endblock %}
